/* Hyperbolic partial differential equation */
#include <stdio.h>
#define _USE_MATH_DEFINES
#include <math.h>
#define M 10
#define N 100
float g(float x)
{ return(0.0); }
int main(void)
{
    int i,j,m,n;
    float c,k,h,r,u[M+1][N+1],v,er;
    c=3.0;
    h=0.2;
    k=0.02;
    r=k/h*c;
    for(j=0;j<=N;j++) {
        for(i=0;i<=M;i++) {
            if(j==0) {
                u[i][j]=0.05*h*i*(2-h*i);
            } else {
                u[i][j]=0.0;
            }
        }
    }

    for(j=0;j<N;j++) {
        if(j==0) {
            for(i=1;i<M;i++)
                u[i][1]=(1.0-r*r)*u[i][0]+(u[i+1][0]
                +u[i-1][0])*r*r/2.0+k*g(i*h);
        } else {
            do {
                er=0.0;
                for(i=1;i<M;i++) {
                    v=2.0*(1.0-r*r)*u[i][j]
                    +r*r*(u[i+1][j]+u[i-1][j])-u[i][j-1];
                    er+=fabs(u[i][j+1]-v);u[i][j+1]=v;
                }
            } while(er>1.0e-5);
        }
    }
    for(j=0;j<=N;j++) {
    printf("%7.3f ",k*j);
    for(i=0;i<=M;i++) printf("%7.3f",u[i][j]);
    printf("\n");
    }
}

/*

  0.000   0.000  0.018  0.032  0.042  0.048  0.050  0.048  0.042  0.032  0.018  0.000
  0.020   0.000  0.018  0.032  0.042  0.048  0.050  0.048  0.042  0.032  0.018  0.000
  0.040   0.000  0.018  0.032  0.042  0.048  0.050  0.048  0.042  0.032  0.018  0.000
  0.060   0.000  0.018  0.032  0.042  0.048  0.050  0.048  0.042  0.032  0.018  0.000
  0.080   0.000  0.018  0.032  0.042  0.048  0.050  0.048  0.042  0.032  0.018  0.000
  0.100   0.000  0.018  0.032  0.042  0.048  0.050  0.048  0.042  0.032  0.018  0.000
  0.120   0.000  0.017  0.031  0.041  0.047  0.049  0.047  0.041  0.031  0.017  0.000
  0.140   0.000  0.017  0.031  0.041  0.047  0.049  0.047  0.041  0.031  0.017  0.000
  0.160   0.000  0.017  0.031  0.041  0.047  0.049  0.047  0.041  0.031  0.017  0.000
  0.180   0.000  0.016  0.030  0.040  0.046  0.048  0.046  0.040  0.030  0.016  0.000
  0.200   0.000  0.016  0.030  0.040  0.046  0.048  0.046  0.040  0.030  0.016  0.000
  0.220   0.000  0.016  0.030  0.040  0.046  0.048  0.046  0.040  0.030  0.016  0.000
  0.240   0.000  0.015  0.029  0.039  0.045  0.047  0.045  0.039  0.029  0.015  0.000
  0.260   0.000  0.015  0.029  0.039  0.045  0.047  0.045  0.039  0.029  0.015  0.000
  0.280   0.000  0.015  0.028  0.038  0.044  0.046  0.044  0.038  0.028  0.015  0.000
  0.300   0.000  0.014  0.028  0.038  0.044  0.046  0.044  0.038  0.028  0.014  0.000
  0.320   0.000  0.014  0.027  0.037  0.043  0.045  0.043  0.037  0.027  0.014  0.000
  0.340   0.000  0.013  0.026  0.036  0.042  0.044  0.042  0.036  0.026  0.013  0.000
  0.360   0.000  0.013  0.026  0.036  0.042  0.044  0.042  0.036  0.026  0.013  0.000
  0.380   0.000  0.013  0.025  0.035  0.041  0.043  0.041  0.035  0.025  0.013  0.000
  0.400   0.000  0.012  0.024  0.034  0.040  0.042  0.040  0.034  0.024  0.012  0.000
  0.420   0.000  0.012  0.024  0.033  0.039  0.041  0.039  0.033  0.024  0.012  0.000
  0.440   0.000  0.011  0.023  0.032  0.038  0.040  0.038  0.032  0.023  0.011  0.000
  0.460   0.000  0.011  0.022  0.031  0.037  0.039  0.037  0.031  0.022  0.011  0.000
  0.480   0.000  0.010  0.021  0.031  0.036  0.038  0.036  0.031  0.021  0.010  0.000
  0.500   0.000  0.010  0.020  0.030  0.036  0.038  0.036  0.030  0.020  0.010  0.000
  0.520   0.000  0.010  0.020  0.029  0.034  0.036  0.034  0.029  0.020  0.010  0.000
  0.540   0.000  0.009  0.019  0.028  0.033  0.035  0.033  0.028  0.019  0.009  0.000
  0.560   0.000  0.009  0.018  0.027  0.032  0.034  0.032  0.027  0.018  0.009  0.000
  0.580   0.000  0.008  0.017  0.025  0.031  0.033  0.031  0.025  0.017  0.008  0.000
  0.600   0.000  0.008  0.016  0.024  0.030  0.032  0.030  0.024  0.016  0.008  0.000
  0.620   0.000  0.008  0.015  0.023  0.029  0.031  0.029  0.023  0.015  0.008  0.000
  0.640   0.000  0.007  0.014  0.022  0.028  0.030  0.028  0.022  0.014  0.007  0.000
  0.660   0.000  0.007  0.014  0.021  0.026  0.028  0.026  0.021  0.014  0.007  0.000
  0.680   0.000  0.006  0.013  0.020  0.025  0.027  0.025  0.020  0.013  0.006  0.000
  0.700   0.000  0.006  0.012  0.018  0.024  0.026  0.024  0.018  0.012  0.006  0.000
  0.720   0.000  0.006  0.011  0.017  0.022  0.024  0.022  0.017  0.011  0.006  0.000
  0.740   0.000  0.005  0.010  0.016  0.021  0.023  0.021  0.016  0.010  0.005  0.000
  0.760   0.000  0.005  0.009  0.015  0.019  0.021  0.019  0.015  0.009  0.005  0.000
  0.780   0.000  0.004  0.009  0.014  0.018  0.020  0.018  0.014  0.009  0.004  0.000
  0.800   0.000  0.004  0.008  0.012  0.016  0.018  0.016  0.012  0.008  0.004  0.000
  0.820   0.000  0.004  0.007  0.011  0.015  0.017  0.015  0.011  0.007  0.004  0.000
  0.840   0.000  0.003  0.006  0.010  0.013  0.015  0.013  0.010  0.006  0.003  0.000
  0.860   0.000  0.003  0.005  0.009  0.012  0.013  0.012  0.009  0.005  0.003  0.000
  0.880   0.000  0.002  0.005  0.007  0.010  0.012  0.010  0.007  0.005  0.002  0.000
  0.900   0.000  0.002  0.004  0.006  0.009  0.010  0.009  0.006  0.004  0.002  0.000
  0.920   0.000  0.002  0.003  0.005  0.007  0.008  0.007  0.005  0.003  0.002  0.000
  0.940   0.000  0.001  0.002  0.004  0.005  0.006  0.005  0.004  0.002  0.001  0.000
  0.960   0.000  0.001  0.002  0.002  0.004  0.005  0.004  0.002  0.002  0.001  0.000
  0.980   0.000  0.000  0.001  0.001  0.002  0.003  0.002  0.001  0.001  0.000  0.000
  1.000   0.000  0.000  0.000 -0.000  0.000  0.001  0.000 -0.000  0.000  0.000  0.000
  1.020   0.000 -0.000 -0.001 -0.001 -0.001 -0.001 -0.001 -0.001 -0.001 -0.000  0.000
  1.040   0.000 -0.001 -0.002 -0.003 -0.003 -0.003 -0.003 -0.003 -0.002 -0.001  0.000
  1.060   0.000 -0.001 -0.002 -0.004 -0.004 -0.004 -0.004 -0.004 -0.002 -0.001  0.000
  1.080   0.000 -0.002 -0.003 -0.005 -0.006 -0.006 -0.006 -0.005 -0.003 -0.002  0.000
  1.100   0.000 -0.002 -0.004 -0.006 -0.008 -0.008 -0.008 -0.006 -0.004 -0.002  0.000
  1.120   0.000 -0.002 -0.005 -0.007 -0.009 -0.010 -0.009 -0.007 -0.005 -0.002  0.000
  1.140   0.000 -0.003 -0.006 -0.008 -0.011 -0.012 -0.011 -0.008 -0.006 -0.003  0.000
  1.160   0.000 -0.003 -0.006 -0.010 -0.013 -0.014 -0.013 -0.010 -0.006 -0.003  0.000
  1.180   0.000 -0.004 -0.007 -0.011 -0.014 -0.015 -0.014 -0.011 -0.007 -0.004  0.000
  1.200   0.000 -0.004 -0.008 -0.012 -0.016 -0.017 -0.016 -0.012 -0.008 -0.004  0.000
  1.220   0.000 -0.004 -0.009 -0.013 -0.017 -0.019 -0.017 -0.013 -0.009 -0.004  0.000
  1.240   0.000 -0.005 -0.010 -0.014 -0.019 -0.020 -0.019 -0.014 -0.010 -0.005  0.000
  1.260   0.000 -0.005 -0.010 -0.015 -0.020 -0.022 -0.020 -0.015 -0.010 -0.005  0.000
  1.280   0.000 -0.006 -0.011 -0.017 -0.022 -0.024 -0.022 -0.017 -0.011 -0.006  0.000
  1.300   0.000 -0.006 -0.012 -0.018 -0.023 -0.025 -0.023 -0.018 -0.012 -0.006  0.000
  1.320   0.000 -0.006 -0.013 -0.019 -0.024 -0.027 -0.024 -0.019 -0.013 -0.006  0.000
  1.340   0.000 -0.007 -0.014 -0.020 -0.026 -0.028 -0.026 -0.020 -0.014 -0.007  0.000
  1.360   0.000 -0.007 -0.014 -0.021 -0.027 -0.030 -0.027 -0.021 -0.014 -0.007  0.000
  1.380   0.000 -0.008 -0.015 -0.022 -0.028 -0.031 -0.028 -0.022 -0.015 -0.008  0.000
  1.400   0.000 -0.008 -0.016 -0.023 -0.030 -0.032 -0.030 -0.023 -0.016 -0.008  0.000
  1.420   0.000 -0.008 -0.017 -0.024 -0.031 -0.034 -0.031 -0.024 -0.017 -0.008  0.000
  1.440   0.000 -0.009 -0.017 -0.025 -0.032 -0.035 -0.032 -0.025 -0.017 -0.009  0.000
  1.460   0.000 -0.009 -0.018 -0.026 -0.033 -0.036 -0.033 -0.026 -0.018 -0.009  0.000
  1.480   0.000 -0.010 -0.019 -0.028 -0.034 -0.037 -0.034 -0.028 -0.019 -0.010  0.000
  1.500   0.000 -0.010 -0.020 -0.029 -0.035 -0.038 -0.035 -0.029 -0.020 -0.010  0.000
  1.520   0.000 -0.010 -0.020 -0.030 -0.036 -0.039 -0.036 -0.030 -0.020 -0.010  0.000
  1.540   0.000 -0.011 -0.021 -0.031 -0.037 -0.040 -0.037 -0.031 -0.021 -0.011  0.000
  1.560   0.000 -0.011 -0.022 -0.032 -0.038 -0.041 -0.038 -0.032 -0.022 -0.011  0.000
  1.580   0.000 -0.011 -0.023 -0.032 -0.039 -0.042 -0.039 -0.032 -0.023 -0.011  0.000
  1.600   0.000 -0.012 -0.023 -0.033 -0.040 -0.042 -0.040 -0.033 -0.023 -0.012  0.000
  1.620   0.000 -0.012 -0.024 -0.034 -0.041 -0.043 -0.041 -0.034 -0.024 -0.012  0.000
  1.640   0.000 -0.013 -0.025 -0.035 -0.042 -0.044 -0.042 -0.035 -0.025 -0.013  0.000
  1.660   0.000 -0.013 -0.025 -0.036 -0.042 -0.044 -0.042 -0.036 -0.025 -0.013  0.000
  1.680   0.000 -0.013 -0.026 -0.037 -0.043 -0.045 -0.043 -0.037 -0.026 -0.013  0.000
  1.700   0.000 -0.014 -0.027 -0.037 -0.044 -0.046 -0.044 -0.037 -0.027 -0.014  0.000
  1.720   0.000 -0.014 -0.027 -0.038 -0.044 -0.046 -0.044 -0.038 -0.027 -0.014  0.000
  1.740   0.000 -0.014 -0.028 -0.039 -0.045 -0.047 -0.045 -0.039 -0.028 -0.014  0.000
  1.760   0.000 -0.015 -0.028 -0.039 -0.045 -0.047 -0.045 -0.039 -0.028 -0.015  0.000
  1.780   0.000 -0.015 -0.029 -0.040 -0.046 -0.047 -0.046 -0.040 -0.029 -0.015  0.000
  1.800   0.000 -0.015 -0.029 -0.040 -0.046 -0.048 -0.046 -0.040 -0.029 -0.015  0.000
  1.820   0.000 -0.016 -0.030 -0.041 -0.047 -0.048 -0.047 -0.041 -0.030 -0.016  0.000
  1.840   0.000 -0.016 -0.030 -0.041 -0.047 -0.048 -0.047 -0.041 -0.030 -0.016  0.000
  1.860   0.000 -0.016 -0.030 -0.041 -0.047 -0.049 -0.047 -0.041 -0.030 -0.016  0.000
  1.880   0.000 -0.016 -0.031 -0.042 -0.047 -0.049 -0.047 -0.042 -0.031 -0.016  0.000
  1.900   0.000 -0.017 -0.031 -0.042 -0.048 -0.049 -0.048 -0.042 -0.031 -0.017  0.000
  1.920   0.000 -0.017 -0.031 -0.042 -0.048 -0.049 -0.048 -0.042 -0.031 -0.017  0.000
  1.940   0.000 -0.017 -0.032 -0.042 -0.048 -0.050 -0.048 -0.042 -0.032 -0.017  0.000
  1.960   0.000 -0.017 -0.032 -0.042 -0.048 -0.050 -0.048 -0.042 -0.032 -0.017  0.000
  1.980   0.000 -0.017 -0.032 -0.042 -0.048 -0.050 -0.048 -0.042 -0.032 -0.017  0.000
  2.000   0.000 -0.017 -0.032 -0.042 -0.048 -0.050 -0.048 -0.042 -0.032 -0.017  0.000
*/